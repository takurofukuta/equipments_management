<h1>Equipments#index</h1>

<p>備品データの追加</p>
<%= form_with model: @equipment, url: equipments_path, method: :post, local: true do |f| %>
  <div>
    <%= f.label :genre %>
    <%= f.select :genre, Equipment.genres_i18n.invert %>
  </div>
  <p>研究室用備品名：<%= f.text_field :lab_equipment_name %></p>
  <p>メーカー名：<%= f.text_field :maker_name %></p>
  <p>製品名：<%= f.text_field :product_name %></p>
  <div>
    <%= f.label :purchase_year %>
    <%= f.select :purchase_year, options_for_select((1990..2100).to_a) %>
  </div>
  <p>資産番号：<%= f.text_field :asset_num %></p>
  <p>金額：<%= f.text_field :price %></p>
  <p>備考：<%= f.text_field :remarks %></p>
  <%= f.submit "送信" %>
<% end %>

<%= link_to "CSVエクスポート",equipments_path(format: :csv) %>
<%= search_form_for @q, url: equipments_path do |f| %>
  <%= f.label :genre_eq, "備品ジャンル" %>
  <%= f.select :genre_eq, Equipment.genres.map{|k, v| [Equipment.genres_i18n[k], v]}, { include_blank: '指定なし' } %>
  <%= f.label :purchase_year_eq, "購入年" %>
  <%= f.select :purchase_year_eq, options_for_select((1990..2100).to_a) , { include_blank: '指定なし' } %>
  <%= f.label :lab_equipment_name_or_maker_name_or_asset_num_cont, "その他項目" %>
  <%= f.search_field :lab_equipment_name_or_maker_name_or_asset_num_cont, placeholder: "入力してください" %>
  <%= f.submit "検索" %>
<% end %>

<%= paginate @equipments %>
<table border = "1">
  <thead>
    <tr>
      <th scope = "col">備品ジャンル</th>
      <th scope = "col">研究室用備品名</th>
      <th scope = "col">メーカー名</th>
      <th scope = "col">製品名</th>
      <th scope = "col">購入年度</th>
      <th scope = "col">資産番号</th>
      <th scope = "col">ステータス</th>
      <th scope = "col"></th>
    </tr>
  </thead>
  <tbody>
    <% @equipments.each do |equipment| %>
      <tr>
        <td><%= equipment.genre_i18n %></td>
        <td><%= equipment.lab_equipment_name %></td>
        <td><%= equipment.maker_name %></td>
        <td><%= equipment.product_name %></td>
        <td><%= equipment.purchase_year %></td>
        <td><%= equipment.asset_num %></td>
        <td>返却済 / 廃棄済</td>
        <td>
        <%= link_to "詳細", equipment_path(equipment) %>
        <%= link_to "編集", edit_equipment_path(equipment) %>

        <% if equipment.lendings_status == 0 %>
          <%= link_to "貸出", {controller: "lendings", action: "lending", id: equipment.id}, method: :post %>
        <% elsif equipment.lendings_status == 1 %>
          貸出中
        <% end %>

        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= paginate @equipments %>